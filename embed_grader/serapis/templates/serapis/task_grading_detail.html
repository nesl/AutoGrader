{% extends 'serapis/base_sidebar.html' %}
{% load staticfiles %}
{% load guardian_tags %}
{% load submission_tags %}

{% block profile-usertitle-name %}
  Submission
{% endblock %}

{% block profile-usertitle-job %}
  {{ assignment.name }}
{% endblock %}

{% block submissions-active %}active{% endblock %}

{% block main-content %}
  <div class="main-content">
    <div class="top-buffer">
      <ol class="breadcrumb">
        <li><a href="{% url 'homepage' %}">Courses</a></li>
        <li><a href="{% url 'course' course.id %}">{{ course.course_code }}</a></li>
        <li><a href="{% url 'assignment' assignment.id %}">{{ assignment.name }}</a></li>
        <li><a href="{% url 'submission' submission.id %}">submission detail ({{submission.id}})</a></li>
        <li>{{ assignment_task.brief_description }}</li>
      </ol>
    </div>

    <h3 class="page-header">Grading Detail</h3>

    <h5>Student: {{ author.first_name }} {{ author.last_name }}</h5>
    <h5>Submission time: {{ submission.submission_time }}</h5>
    <h5>Submission ID: {{ submission.id }}</h5>
    <h5>Task case: {{ assignment_task.brief_description }}</h5>
    <h5>Score: {% show_score grading.points assignment_task.points %}</h5>
    
    <hr/>
    <h4>Grading feedback:<h4>
    <p style="white-space:pre; font-size:13px; font-family:monospace">{{feedback}}</p>

    {% for output in output_log %}
      <hr/>
      <h4>File: {{output.field_name}} 
        <a href="{{ MEDIA_URL }}{{ output.url }}" class="btn btn-primary" 
        style="font-size:12px; background:white; color:SteelBlue; border-color:SteelBlue;">
          <span class="glyphicon glyphicon-download-alt"></span> &nbsp;Download   
        </a>
      <h4>
      <br/>
      <p style="white-space:pre; font-size:13px; font-family:monospace">{{output.content}}</p>
    {% endfor %}


      <!-- Generating Waveform -->
      <!-- <script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
      <script src="https://www.amcharts.com/lib/3/serial.js"></script>
      <script src="https://www.amcharts.com/lib/3/xy.js"></script>
      <script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
      <link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all"/>
      <script src="https://www.amcharts.com/lib/3/themes/light.js"></script>
      <div id="waveform3" style="width:100%; height:300px;"></div>
      <div id="waveform4" style="width:100%; height:300px;"></div>
      <div id="waveform0" style="width:100%; height:300px;"></div>
      <div id="waveform1" style="width:100%; height:300px;"></div>
      <div id="waveform2" style="width:100%; height:300px;"></div> -->

      <!-- <script type="text/javascript">
      {% autoescape off %}
      var plot_pack = {{ js_plot_pack_string }};
      {% endautoescape %}

      charts = []
      for (var cid = 0; cid < plot_pack.data.length; cid++) {
        waveform_data = [];
        for (var i = 0; i < plot_pack.data[cid].length; i++){
        waveform_data.push({
          "tick": plot_pack.time[i],
          "value": plot_pack.data[cid][i]
        });
        }
        max_tick = plot_pack.time[i-1]

        gid = "g" + cid;
        charts[cid] = AmCharts.makeChart("waveform" + cid, {
        "type": "xy",
        "titles": [{"text": plot_pack.labels[cid]}],
        "theme": "light",
        "autoMarginOffset": 25,
        "dataProvider": waveform_data,
        "graphs": [{
          "id": gid,
          "balloonText": "[[tick]]<br><b>[[value]]</b>",
          "type": "step",
          "lineThickness": 2,
          "bullet": "square",
          "bulletAlpha": 0,
          "bulletSize": 4,
          "bulletBorderAlpha": 0,
          //"valueField": "value"
          "xField": "tick",
          "yField": "value",
        }],
        "valueAxes": [
          {
            "axisAlpha":0,
          },
          {
            "axisAlpha": 0,
            "title": "Time in Ticks",
            "position": "bottom",
            "maximum": max_tick,
          }
        ],
        "chartScrollbar": {},
        "chartCursor": {},
        "export": {
          "enabled": true
        }
        });

        //function zoomChart() {
        //  charts[cid].zoomToIndexes(0, 20);
        //}
        //charts[cid].addListener("dataUpdated", zoomChart);
      }
      </script> -->
  </div>
    
{% endblock %}
